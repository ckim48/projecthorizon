{# templates/tutorial.html #}
{% extends "base.html" %}

{% block title %}Protocol | Project Horizon{% endblock %}

{% block content %}
<div class="protocol-container">

  <div class="container pt-5 pb-4">
    <div class="protocol-header">
      <div class="mono text-cyan mb-2">INITIALIZATION_SEQUENCE</div>
      <h1 class="display-4 fw-bold">Simulation Protocol</h1>
      <p class="text-muted col-lg-6">
        Follow the 4-step sequence to run the Horizon engine. Each decision updates the scenario trajectory and your profile signals.
      </p>
    </div>
  </div>

  <div class="container">
    <div class="protocol-steps">

      <!-- STEP 1 -->
      <div class="p-step">
        <div class="p-content">
          <div class="p-number">01</div>
          <h2 class="p-title">Simulation Input</h2>
          <p class="p-desc">
            Configure the simulation seed on the <strong>simulation_input</strong> page. This defines the context, constraints, and initial parameters used to generate your scenario.
          </p>
          <div class="p-status"><span class="pulse"></span> Start here</div>
        </div>
        <div class="p-media">
          <div class="media-frame">
            <div class="media-box">
              <img src="{{ url_for('static', filename='img/tutorial/step1.png') }}" onerror="this.style.display='none'">
              <div class="p-placeholder">STP_01_SIM_INPUT_IMG</div>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 2 -->
      <div class="p-step p-reverse">
        <div class="p-content">
          <div class="p-number">02</div>
          <h2 class="p-title">Decision Loop</h2>
          <p class="p-desc">
            Move to the <strong>main decision page</strong> where you choose an option and immediately see the next scenario state.
            This is the core iterative loop of the simulation.
          </p>
          <div class="p-status"><span class="pulse"></span> Make decisions</div>
        </div>
        <div class="p-media">
          <div class="media-frame">
            <div class="media-box">
              <img src="{{ url_for('static', filename='img/tutorial/step2.png') }}" onerror="this.style.display='none'">
              <div class="p-placeholder">STP_02_DECISION_LOOP_IMG</div>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 3 -->
      <div class="p-step">
        <div class="p-content">
          <div class="p-number">03</div>
          <h2 class="p-title">Library</h2>
          <p class="p-desc">
            Use the <strong>library page</strong> to browse curated scenarios and replay research items.
            This supports consistent runs and controlled comparisons.
          </p>
          <div class="p-status"><span class="pulse"></span> Browse scenarios</div>
        </div>
        <div class="p-media">
          <div class="media-frame">
            <div class="media-box">
              <img src="{{ url_for('static', filename='img/tutorial/step3.png') }}" onerror="this.style.display='none'">
              <div class="p-placeholder">STP_03_LIBRARY_IMG</div>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 4 -->
      <div class="p-step p-reverse">
        <div class="p-content">
          <div class="p-number">04</div>
          <h2 class="p-title">Profile</h2>
          <p class="p-desc">
            Review your results on the <strong>profile page</strong>. Charts summarize your decision axes, type distribution,
            drift over time, and recent history.
          </p>
          <div class="p-status"><span class="pulse"></span> Analyze outcomes</div>
        </div>
        <div class="p-media">
          <div class="media-frame">
            <div class="media-box">
              <img src="{{ url_for('static', filename='img/tutorial/step4.png') }}" onerror="this.style.display='none'">
              <div class="p-placeholder">STP_04_PROFILE_IMG</div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="text-center py-5">
      <!-- Start at Step 1 -->
      <a href="/simulation_input" class="btn-protocol">BEGIN INITIALIZATION</a>
    </div>
  </div>
</div>

<style>
  :root {
    --bg-dark: #0a0b0d;
    --cyan: #00e7ff;
    --glass: rgba(255, 255, 255, 0.03);
    --border: rgba(255, 255, 255, 0.10);
    --border-strong: rgba(0, 231, 255, 0.26);
  }

  body { background-color: var(--bg-dark); color: #fff; font-family: 'Inter', sans-serif; }
  .mono { font-family: 'JetBrains Mono', monospace; letter-spacing: 2px; }
  .text-cyan { color: var(--cyan); }

  .protocol-steps {
    display: flex;
    flex-direction: column;
    gap: 80px;
    margin-top: 40px;
  }

  .p-step {
    display: flex;
    align-items: center;
    gap: 60px;
    min-height: 350px;
  }

  .p-reverse { flex-direction: row-reverse; }

  .p-content { flex: 1; }

  .p-media {
    flex: 1;
    display: flex;
    justify-content: center;
  }

  .p-number {
    font-family: 'JetBrains Mono';
    font-size: 1.2rem;
    color: var(--cyan);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .p-number::after {
    content: "";
    height: 1px;
    width: 60px;
    background: var(--cyan);
    display: inline-block;
  }

  .p-title { font-size: 2.2rem; font-weight: 800; margin-bottom: 1.5rem; }
  .p-desc { font-size: 1.1rem; color: #a0a0a0; line-height: 1.6; }

  /* ===== Modern Framed Media (UPDATED) ===== */
  .media-frame{
    width: 100%;
    max-width: 520px;
    border-radius: 18px;
    padding: 1px;
    background:
      linear-gradient(180deg, rgba(0,231,255,0.22), rgba(255,255,255,0.06));
    box-shadow:
      0 20px 55px rgba(0,0,0,0.55),
      0 0 0 1px rgba(255,255,255,0.06) inset;
  }

  .media-box {
    width: 100%;
    aspect-ratio: 16/10;
    border-radius: 17px;
    background:
      radial-gradient(1200px 500px at 30% 0%, rgba(0,231,255,0.10), transparent 55%),
      rgba(0,0,0,0.65);
    border: 1px solid var(--border);
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* subtle inner line */
  .media-box::before{
    content:"";
    position:absolute;
    inset: 10px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
    pointer-events:none;
  }

  .media-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display:block;
    transform: scale(1.01);
    filter: contrast(1.02) saturate(1.02);
  }

  .p-placeholder {
    position:absolute;
    bottom: 12px;
    left: 14px;
    font-family: 'JetBrains Mono';
    font-size: 0.72rem;
    letter-spacing: 1px;
    color: rgba(255,255,255,0.55);
    background: rgba(0,0,0,0.35);
    border: 1px solid rgba(255,255,255,0.10);
    padding: 6px 10px;
    border-radius: 999px;
    backdrop-filter: blur(6px);
  }

  .p-status {
    margin-top: 2rem;
    font-size: 0.8rem;
    text-transform: uppercase;
    color: var(--cyan);
    font-family: 'JetBrains Mono';
  }

  .pulse {
    height: 8px; width: 8px;
    background: var(--cyan);
    border-radius: 50%;
    display: inline-block;
    margin-right: 8px;
    box-shadow: 0 0 10px var(--cyan);
    animation: p-pulse 2s infinite;
  }

  @keyframes p-pulse {
    0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; }
  }

  .btn-protocol {
    padding: 18px 45px;
    border: 1px solid var(--cyan);
    color: var(--cyan);
    text-decoration: none;
    font-family: 'JetBrains Mono';
    font-weight: bold;
    transition: 0.3s ease;
  }

  .btn-protocol:hover {
    background: var(--cyan);
    color: #000;
    box-shadow: 0 0 30px rgba(0, 231, 255, 0.4);
  }

  @media (max-width: 992px) {
    .p-step, .p-reverse {
      flex-direction: column !important;
      gap: 30px;
      text-align: center;
    }
    .p-number { justify-content: center; }
    .p-number::after { display: none; }
  }
</style>
{% endblock %}
